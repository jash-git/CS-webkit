<!DOCTYPE html>
<!-- saved from url=(0088)https://hk.saowen.com/a/c34a50f0182958d8f6f18b6e6eed1b3238293819551b790f22a91e1d5997931d -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" async="" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/analytics.js.下載"></script><script src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/osd.js.下載"></script><script src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/ca-pub-6601249682792819.js.下載"></script><script type="text/javascript" async="" defer="" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/js"></script><script type="text/javascript">
      var _speedMark = new Date();
    </script>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯</title>
    <meta name="description" content="">
    <meta name="HandheldFriendly" content="True">
    <meta name="referrer" content="never">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="CoreCMS Alpha v0.1">
    <meta property="og:site_name" content="扫文资讯">
    <meta property="og:type" content="article">
    <meta property="og:title" content="【转】C# 开发Chrome内核浏览器(WebKit.net)">    <meta property="og:description" content="">
    <meta property="og:image" content="Array">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:width" content="640"> 
    <meta property="og:image:height" content="442">
    <meta property="og:image:secure_url" content="Array">
    <meta property="og:description" content="">
    <meta name="keywords" content="webkit,net,webkitbrowser,使用,webbrowser,http,调用,网页,browser,new,ie,下载,js,void,一个,文档,this,内核,sender,object,显示,对象,html,csharp,view,form,可以,css,浏览器,windows">
    <meta name="description" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="【转】C# 开发Chrome内核浏览器(WebKit.net)">
    <meta name="twitter:description" content="">
    <link rel="icon" href="https://storages.cdn.saowen.com/static/img/Saowen_Icon_192_@3x.png" type="image/png">
    <link rel="shortcut icon" href="https://storages.cdn.saowen.com/static/img/Saowen_Icon_192.png" type="image/png">
    <link rel="stylesheet" type="text/css" href="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/screen.css">
    <link rel="dns-prefetch preconnect" href="https://www.google-analytics.com/">
    <link rel="dns-prefetch preconnect" href="https://pagead2.googlesyndication.com/">
    <link rel="dns-prefetch preconnect" href="https://googleads.g.doubleclick.net/">
    <link rel="dns-prefetch preconnect" href="https://www.googletagmanager.com/">
<script async="" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/f.txt"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6601249682792819",
    enable_page_level_ads: true
  });
</script>
<!-- Analytics.soft.org -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.soft.org/";
    _paq.push(['setTrackerUrl', u+'put']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Analytics.soft.org Code -->
<script src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/embed.js.下載" data-timestamp="1547536057461"></script><link rel="preload" href="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/f(1).txt" as="script"><script type="text/javascript" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/f(1).txt"></script><link rel="preload" href="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/f(2).txt" as="script"><script type="text/javascript" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/f(2).txt"></script><link rel="preload" href="https://pagead2.googlesyndication.com/pagead/js/r20190109/r20180604/show_ads_impl.js" as="script"><link rel="preload" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.d49f53e192b9080ef8880a7c9b24f1c3.css"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.81998d48c30a90f1e372f73e226bece4.js"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.eb7b5137116db258599fe20d5d9253f6.js"><link rel="preload" as="script" href="https://disqus.com/next/config.js"><script src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/alfalfa_min.d078e4f2a4721192a99e02601a767617.js.下載" async="" charset="UTF-8"></script></head>
<body class="post-template nav-closed">
    <div class="nav">
        <h3 class="nav-title">Menu</h3>
        <a href="javascript:void(0)" class="nav-close" data-no-instant="">
            <span class="hidden">Close</span>
        </a>
        <ul>
        <li class="nav-home" role="presentation"><a href="https://hk.saowen.com/">Home</a></li>
        <li class="nav-docker" role="presentation"><a href="https://tw.saowen.com/">台湾</a></li>
        <li class="nav-raspberry-pi" role="presentation"><a href="https://hk.saowen.com/">香港</a></li>
    </ul></div>
    <span class="nav-cover"></span>
    <div class="site-wrapper">
        <header class="main-header post-head no-cover">
            <nav class="main-nav clearfix">
                <a class="menu-button icon-menu" href="https://hk.saowen.com/"><span class="word">Home</span></a>
            </nav>
        </header>
        <main class="content" role="main">
            <article class="post" id="img-content">
                <header class="post-header">
                    <h1 class="post-title">【转】C# 开发Chrome内核浏览器(WebKit.net)</h1>
                    <section class="post-meta">
                        <time class="post-date" datetime="2018-01-01">2018-01-01 / views: 471</time>
                    </section>
                </header>

                <section class="post-content">
                  <div class="blogpost-body" id="cnblogs_post_body">
<p>WebKit.net是对WebKit的.Net封装，使用它.net进程可以非常方便的集成和使用webkit作为加载网页的容器。这里介绍一下怎么用它来显示一个网页这样的一个最简单的功能。</p>
<h5>第一步：</h5>
<p>下载WebKit.net 的bin文档。别小看这一步，你不一定能下载成功，原因你懂的。</p>
<p>WebKit.net 的主页是<a href="https://hk.saowen.com/rd/aHR0cDovL3dlYmtpdGRvdG5ldC5zb3VyY2Vmb3JnZS5uZXQv" target="_blank" ref="nofollow">http://webkitdotnet.sourceforge.net/</a></p>
<p>直接下载0.5版本的windows bin文档地址为：<a href="https://hk.saowen.com/rd/aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvd2Via2l0ZG90bmV0L2ZpbGVzL1dlYktpdCUyMC5ORVQlMjAwLngvMC41L1dlYktpdC5ORVQtMC41LWJpbi1jYWlyby56aXAvZG93bmxvYWQ=" target="_blank" ref="nofollow">https://sourceforge.net/projects/webkitdotnet/files/WebKit%20.NET%200.x/0.5/WebKit.NET-0.5-bin-cairo.zip/download</a></p>
<h5>第二步：</h5>
<p>新建一个WindowsForms工程。</p>
<p><a href="https://hk.saowen.com/rd/aHR0cDovL3N0YXRpYy5vc2NoaW5hLm5ldC91cGxvYWRzL2ltZy8yMDEyMDgvMDcyMDM3MzdfRDJxbi5wbmc=" target="_blank" ref="nofollow"><img alt="image" height="153" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/07203737_D2qn.png" title="image" width="498"></a></p>
<p>然后把下载好的webkit.net bin目录下的所有文档复制到新建工程的bin/Debug/目录下。</p>
<p>添加引用，通过浏览添加对“WebKitBrowser.dll”的引用。</p>
<p><a href="https://hk.saowen.com/rd/aHR0cDovL3N0YXRpYy5vc2NoaW5hLm5ldC91cGxvYWRzL2ltZy8yMDEyMDgvMDcyMDM3MzhfbVZuNS5wbmc=" target="_blank" ref="nofollow"><img alt="image" height="307" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/07203738_mVn5.png" title="image" width="475"></a></p>
<h5>第三步：</h5>
<p>来写写代码了。双击Form1的窗体进入代码，写下这几行代码：</p>
<pre> private void Form1_Load(object sender, EventArgs e)
        {
            WebKit.WebKitBrowser browser = new WebKitBrowser();
            browser.Dock = DockStyle.Fill;
            this.Controls.Add(browser);
            browser.Navigate("<a class="vglnk" href="http://www.lixin.me/" rel="nofollow"><span>http</span><span>://</span><span>www</span><span>.</span><span>lixin</span><span>.</span><span>me</span></a>");
        }</pre>
<p>运行看看效果：</p>
<p><a href="https://hk.saowen.com/rd/aHR0cDovL3N0YXRpYy5vc2NoaW5hLm5ldC91cGxvYWRzL2ltZy8yMDEyMDgvMDcyMDM3MzlfVGJ5QS5wbmc=" target="_blank" ref="nofollow"><img alt="李鑫的个人主页" height="260" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/07203739_TbyA.png" title="李鑫的个人主页" width="644"></a></p>
<h5>与IE内核的WebBrowser对比：</h5>
<p>非常简单的三步就完成了。可是话说回来了，时下都流行一步到位的，例如使用System.Windows.Forms.WebBrowser 。</p>
<p>使用.Net框架自带的，调用IE内核的WebBrowser来显示网页也许更简单些，只需要在新建的工程中写下这么几行代码便可：</p>
<pre>  private void Form1_Load(object sender, EventArgs e)
        {
            WebBrowser browser = new WebBrowser();
            browser.Dock = DockStyle.Fill;
            this.Controls.Add(browser);
            browser.Navigate("<a class="vglnk" href="http://www.lixin.me/" rel="nofollow"><span>http</span><span>://</span><span>www</span><span>.</span><span>lixin</span><span>.</span><span>me</span></a>");   
        }</pre>
<p>运行起来的效果看起来差不多，肉眼基本只能看出字体稍微不同而已：</p>
<p><a href="https://hk.saowen.com/rd/aHR0cDovL3N0YXRpYy5vc2NoaW5hLm5ldC91cGxvYWRzL2ltZy8yMDEyMDgvMDcyMDM3NDBfZVdIcC5wbmc=" target="_blank" ref="nofollow"><img alt="image" height="288" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/07203740_eWHp.png" title="image" width="644"></a></p>
<p>既然都差不多，那为什么还不厌其烦的去下载几个M的dll来显示网页呢？这是因为如果使用IE内核的WebBrowser我们无法预知对网页的显示效果，例如你的电脑是xp，可能会调用ie6作为加载器，如果是win7，可能会调用ie8作为加载器，而他们的显示效果是不完全一样的。下面用一个例子来看看。</p>
<p><a href="https://hk.saowen.com/rd/aHR0cDovL2NzczMuenhxLm5ldC9kb3JhZW1vbi9kb3JhZW1vbl9jc3MzLmh0bWw=" target="_blank" ref="nofollow">http://css3.zxq.net/doraemon/doraemon_css3.html</a>&nbsp;这个页面是用来测试浏览器对css3的支持程度的。现在我们分别用2个方法来显示这个页面。</p>
<pre> private void Form1_Load(object sender, EventArgs e)
        {
            WebBrowser browser = new WebBrowser();
            browser.Dock = DockStyle.Fill;
            browser.Navigate("<a class="vglnk" href="http://css3.zxq.net/doraemon/doraemon_css3.html" rel="nofollow"><span>http</span><span>://</span><span>css3</span><span>.</span><span>zxq</span><span>.</span><span>net</span><span>/</span><span>doraemon</span><span>/</span><span>doraemon</span><span>_</span><span>css3</span><span>.</span><span>html</span></a>");
            splitContainer1.Panel1.Controls.Add(browser);

            WebKit.WebKitBrowser kitBrowser = new WebKitBrowser();
            kitBrowser.Dock = DockStyle.Fill;
            kitBrowser.Navigate("<a class="vglnk" href="http://css3.zxq.net/doraemon/doraemon_css3.html" rel="nofollow"><span>http</span><span>://</span><span>css3</span><span>.</span><span>zxq</span><span>.</span><span>net</span><span>/</span><span>doraemon</span><span>/</span><span>doraemon</span><span>_</span><span>css3</span><span>.</span><span>html</span></a>");
            splitContainer1.Panel2.Controls.Add(kitBrowser);
        }</pre>
<p>效果图如下：</p>
<p><a href="https://hk.saowen.com/rd/aHR0cDovL3N0YXRpYy5vc2NoaW5hLm5ldC91cGxvYWRzL2ltZy8yMDEyMDgvMDcyMDM3NDNfZFM1di5wbmc=" target="_blank" ref="nofollow"><img alt="image" height="422" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/07203743_dS5v.png" title="image" width="644"></a></p>
<p>本机的系统是win7+IE9，但是通过WebBrowser调用，估计仍然使用的是IE8内核，所以显示效果很差。</p>
<p>通过这样左右对比，可以看出多了一步麻烦，是有必要的。</p>
<p>from：<a class="vglnk" href="http://www.cnblogs.com/linyijia/p/4045333.html" rel="nofollow"><span>http</span><span>://</span><span>www</span><span>.</span><span>cnblogs</span><span>.</span><span>com</span><span>/</span><span>linyijia</span><span>/</span><span>p</span><span>/</span><span>4045333</span><span>.</span><span>html</span></a></p>
<p>/***********************************************************************/</p>
<p>问：下载了一个第三方的内核浏览器插件webkit.net（版本是2011）,调用网页中的js函数报错：对 COM 组件的调用返回了错误 HRESULT E_FAIL，不知道是因为缺少文档还是其他原因？webkit插件怎么调用网页上的js函数呢？拜托各位</p>
<p>&nbsp;</p>
<p>答：花费了一些时间算是解决了总结一下结论，方便他人。</p>
<p>当需要在客户端显示网页时就要考虑用到浏览器插件，一个是MS的webbrowser，另一个好用的是webkit内核的第三方插件（webkit.net,google的open-webkit-sharp，做手机用的qtwebkit，Firefox的Geoko引擎的Windows Forms包装），webbrowser基本上可以满足需要，但是有一些问题不好解决，比如：IE6、7、8差异性大，用户不同的机器安装的IE内核不同，网页的兼容性，js脚本，不支持html5元素的网页等；令人开心的是老外分享有开源的第三方浏览器插件（下载地址：<a href="https://hk.saowen.com/rd/aHR0cDovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy93ZWJraXRkb3RuZXQv" target="_blank">http://sourceforge.net/projects/webkitdotnet/</a>&nbsp; &nbsp; &nbsp; 一直没有更新最新版本2011），webkit.net可以很好的解决了上面的问题，使用跟webbrowser一样方便，提供的类方法也是很类似，减少学习成本可以很快的上手；其他的几个插件也是可以的，open-webkit-sharp目前更新版本3.0，完善和更新了bug，不过复杂的配置安装过程，全英文的文档，网上也有很多这方便的资料，有时间的或者有必要可以选择这个。</p>
<p>webkit.net调用js函数：</p>
<p>//webKitBrowser1.DocumentText =<br>// "&lt;html&gt;&lt;head&gt;&lt;title&gt;Test Page&lt;/title&gt;&lt;/head&gt;&lt;body&gt;" +<br>// "&lt;p id=\"testelement\" style=\"color: red\"&gt;Hello, World!&lt;/p&gt;" +<br>// "&lt;div&gt;&lt;p&gt;A&lt;/p&gt;&lt;p&gt;B&lt;/p&gt;&lt;p&gt;C&lt;/p&gt;&lt;/div&gt;" +<br>// "&lt;script type=\"text/javascript\"&gt;" +<br>// "function f() { window.open('<a class="vglnk" href="http://www.google.com/" rel="nofollow"><span>http</span><span>://</span><span>www</span><span>.</span><span>google</span><span>.</span><span>com</span></a>', 'myWindow'); }&lt;/script&gt;" +<br>// "&lt;/body&gt;&lt;/html&gt;";<br>webKitBrowser1.IsScriptingEnabled = true;//启用js函数调用<br>string str = webKitBrowser1.StringByEvaluatingJavaScriptFromString("Test()");//参数跟webbrowser有点不一样，方法名加括号，测试时不要直接alert,好像没显示出来</p>
<p>两句代码，js函数定义到需要调用的网页里面，或者直接嵌入一段js也可以，比如上面注释的部分。</p>
<p>from:<a class="vglnk" href="http://q.cnblogs.com/q/50344/" rel="nofollow"><span>http</span><span>://</span><span>q</span><span>.</span><span>cnblogs</span><span>.</span><span>com</span><span>/</span><span>q</span><span>/</span><span>50344</span><span>/</span></a>&nbsp;　　</p>
<p>/**********************************************************************************/</p>
<p><a href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHlmbGNlYXIvYXJ0aWNsZS9kZXRhaWxzLzEwMDU1Mjkz" target="_blank" ref="nofollow">c#winform中使用WebKit传递js对象实现与网页交互</a></p>
<p>有个项目要使用WebBroswer控件，并且要能传递一个js对象供前台调用，用c#的WebBroswer控件很容易实现：</p>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="view plain">view plain</a><a class="CopyToClipboard" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="copy">copy</a>
<div>&nbsp;</div>

</div>

</div>
<ol class="dp-c">
<li class="alt"><span class="keyword">private&nbsp;<span class="keyword">void&nbsp;Form1_Load(<span class="keyword">object&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></span></li>
<li>{&nbsp;&nbsp;</li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;WebBrowser&nbsp;wb&nbsp;=&nbsp;<span class="keyword">new&nbsp;WebBrowser();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;wb.ObjectForScripting&nbsp;=&nbsp;<span class="keyword">new&nbsp;myClass();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt">}&nbsp;&nbsp;</li>

</ol></div>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHlmbGNlYXIvYXJ0aWNsZS9kZXRhaWxzLzEwMDU1Mjkz" title="view plain" target="_blank" ref="nofollow">view plain</a></div>

</div>
<ol class="dp-c" start="1">
<li class="alt"><span class="keyword">private&nbsp;<span class="keyword">void&nbsp;Form1_Load(<span class="keyword">object&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></span></li>
<li>{&nbsp;&nbsp;</li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;WebBrowser&nbsp;wb&nbsp;=&nbsp;<span class="keyword">new&nbsp;WebBrowser();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;wb.ObjectForScripting&nbsp;=&nbsp;<span class="keyword">new&nbsp;myClass();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li class="alt">}&nbsp;&nbsp;</li>

</ol></div>
<p>要传递的js对象必须使用[ComVisibleAttribute]标记为COM 可见：</p>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="view plain">view plain</a><a class="CopyToClipboard" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="copy">copy</a>
<div>&nbsp;</div>

</div>

</div>
<ol class="dp-c">
<li class="alt">[System.Runtime.InteropServices.ComVisibleAttribute(<span class="keyword">true)]&nbsp;&nbsp;</span></li>
<li><span class="keyword">class&nbsp;myClass&nbsp;&nbsp;</span></li>
<li class="alt">{&nbsp;&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public&nbsp;<span class="keyword">void&nbsp;Test()&nbsp;&nbsp;</span></span></li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show(<span class="string">"alert:Test");&nbsp;&nbsp;</span></li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li>
<li>}&nbsp;&nbsp;</li>

</ol></div>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHlmbGNlYXIvYXJ0aWNsZS9kZXRhaWxzLzEwMDU1Mjkz" title="view plain" target="_blank" ref="nofollow">view plain</a></div>

</div>
<ol class="dp-c" start="1">
<li class="alt">[System.Runtime.InteropServices.ComVisibleAttribute(<span class="keyword">true)]&nbsp;&nbsp;</span></li>
<li><span class="keyword">class&nbsp;myClass&nbsp;&nbsp;</span></li>
<li class="alt">{&nbsp;&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public&nbsp;<span class="keyword">void&nbsp;Test()&nbsp;&nbsp;</span></span></li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show(<span class="string">"alert:Test");&nbsp;&nbsp;</span></li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</li>
<li>}&nbsp;&nbsp;</li>

</ol></div>
<p>这样前台就能使用window.external调用myClass的方法： window.external.Test();</p>
<p>如果就这样那就简单了 ,可偏偏项目使用的网站对IE的兼容性极差(吐槽下：个人觉得是IE太烂了，对标准的支持太差)，无奈之下想找寻其他类似的WebBrowser控件，发现几个不错的替换控件：</p>
<ol>
<li>GeokoFx：一个Firefox的Geoko引擎的Windows Forms包装，google上的下载地址：<a href="https://hk.saowen.com/rd/aHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2dlY2tvZngv" target="_blank">http://code.google.com/p/geckofx/</a>&nbsp;官网：<a href="https://hk.saowen.com/rd/aHR0cDovL3d3dy5nZWNrb2Z4Lm9yZy8=" target="_blank">http://www.geckofx.org/</a></li>
<li>WebKit.NET:webkit的.NET封装，下载地址：<a href="https://hk.saowen.com/rd/aHR0cDovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy93ZWJraXRkb3RuZXQv" target="_blank">http://sourceforge.net/projects/webkitdotnet/</a></li>

</ol>
<p><br>本来决定使用GeokoFx，因为项目使用的网站用火狐打开是很快的，但是我找了几天资料也没发现怎么传递个js对象给控件，当发现Qt的webbroswer控件也是封装的WebKit控件时，遂决定使用WebKit，但WebKit.NET也没有直接提供传递对象的方法，后来发现又一个好东西：</p>
<ol>
<li>open-webkit-sharp:对webkit.net的又一次封装，提供了很多新功能。google上下载地址：<a href="https://hk.saowen.com/rd/aHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL29wZW4td2Via2l0LXNoYXJwLw==" target="_blank">http://code.google.com/p/open-webkit-sharp/</a></li>

</ol>
<p>下面的使用就非常简单了，下载open-webkit-sharp后，把Core文档夹和References文档夹下所有文档拷贝到你的工程目录下，然后打开你的项目，添加引用OpenWebKitSharp.dll和WebKit.Interop.dll(如果你的项目运行在.NET Framework 2.0 或 3.5 引用 Binary_NET2文档夹下的这两个文档，NET4.0的话就引用Binary文档夹下的这两个dll)；然后就是工具箱-&gt;选择项-&gt;选择OpenWebKitSharp.dll，然后从工具箱中把WebKitBrowser拖到你的窗体上.现在已经成功了一大步了，但是为了避免使用时遇到各种错误，我们需要先安装两个支持文档：</p>
<ol>
<li>Microsoft C++ 2005 Redistributable&nbsp;<a href="https://hk.saowen.com/rd/aHR0cDovL3d3dy5taWNyb3NvZnQuY29tL2Rvd25sb2FkL2VuL2RldGFpbHMuYXNweD9pZD0yNjM0Nw==" target="_blank">http://www.microsoft.com/download/en/details.aspx?id=26347Windows</a>&nbsp;XP/Vista/7 32/64 Bit</li>
<li>Apple QuickTime (Optional - for better HTML5 Support)&nbsp;</li>

</ol>
<p>Ready！开始传递对象：</p>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="view plain">view plain</a><a class="CopyToClipboard" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="copy">copy</a>
<div>&nbsp;</div>

</div>

</div>
<ol class="dp-c">
<li class="alt"><span class="keyword">private&nbsp;<span class="keyword">void&nbsp;Form1_Load(<span class="keyword">object&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></span></li>
<li>{&nbsp;&nbsp;</li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this.webKitBrowser1.Navigate(<span class="string">"<a class="vglnk" href="http://yourwebsiteurl/" rel="nofollow"><span>http</span><span>://</span><span>yourWebSiteUrl</span></a>");&nbsp;&nbsp;</span></span></li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this.webKitBrowser1.DocumentCompleted&nbsp;+=&nbsp;<span class="keyword">new&nbsp;WebBrowserDocumentCompletedEventHandler(webKitBrowser1_DocumentCompleted);&nbsp;&nbsp;</span></span></li>
<li class="alt">}&nbsp;&nbsp;</li>
<li><span class="keyword">void&nbsp;webKitBrowser1_DocumentCompleted(<span class="keyword">object&nbsp;sender,&nbsp;WebBrowserDocumentCompletedEventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li>
<li class="alt">{&nbsp;&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this.webKitBrowser1.GetScriptManager.ScriptObject&nbsp;=&nbsp;<span class="keyword">new&nbsp;myClass();&nbsp;&nbsp;</span></span></li>
<li class="alt">}&nbsp;&nbsp;</li>

</ol></div>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHlmbGNlYXIvYXJ0aWNsZS9kZXRhaWxzLzEwMDU1Mjkz" title="view plain" target="_blank" ref="nofollow">view plain</a></div>

</div>
<ol class="dp-c" start="1">
<li class="alt"><span class="keyword">private&nbsp;<span class="keyword">void&nbsp;Form1_Load(<span class="keyword">object&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></span></li>
<li>{&nbsp;&nbsp;</li>
<li class="alt">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this.webKitBrowser1.Navigate(<span class="string">"<a class="vglnk" href="http://yourwebsiteurl/" rel="nofollow"><span>http</span><span>://</span><span>yourWebSiteUrl</span></a>");&nbsp;&nbsp;</span></span></li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this.webKitBrowser1.DocumentCompleted&nbsp;+=&nbsp;<span class="keyword">new&nbsp;WebBrowserDocumentCompletedEventHandler(webKitBrowser1_DocumentCompleted);&nbsp;&nbsp;</span></span></li>
<li class="alt">}&nbsp;&nbsp;</li>
<li><span class="keyword">void&nbsp;webKitBrowser1_DocumentCompleted(<span class="keyword">object&nbsp;sender,&nbsp;WebBrowserDocumentCompletedEventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li>
<li class="alt">{&nbsp;&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this.webKitBrowser1.GetScriptManager.ScriptObject&nbsp;=&nbsp;<span class="keyword">new&nbsp;myClass();&nbsp;&nbsp;</span></span></li>
<li class="alt">}&nbsp;&nbsp;</li>

</ol></div>
<p>前台调用方式类似IE的webbroswer，也使用window.external调用，你也可以自己定义一个对象：</p>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="view plain">view plain</a><a class="CopyToClipboard" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank" title="copy">copy</a>
<div>&nbsp;</div>

</div>

</div>
<ol class="dp-c">
<li class="alt"><span class="keyword">this.webKitBrowser1.GetScriptManager.EvaluateScript(<span class="string">"var&nbsp;obj=window.external;");&nbsp;&nbsp;</span></span></li>

</ol></div>
<div class="dp-highlighter bg_csharp">
<div class="bar">
<div class="tools"><strong>[csharp]</strong>&nbsp;<a class="ViewSource" href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbHlmbGNlYXIvYXJ0aWNsZS9kZXRhaWxzLzEwMDU1Mjkz" title="view plain" target="_blank" ref="nofollow">view plain</a></div>

</div>
<ol class="dp-c" start="1">
<li class="alt"><span class="keyword">this.webKitBrowser1.GetScriptManager.EvaluateScript(<span class="string">"var&nbsp;obj=window.external;");&nbsp;&nbsp;</span></span></li>

</ol></div>
<p>这样调用的时候就能用你自己定义的对象名访问了。</p>
<p>应该也有直接自己定义对象的方法，但是open-webkit-sharp中文的资料实在的不多，耐着性子看了几天老外的论坛，一水的全是吐槽，实际解决问题的不多。等有更好的方法，也请大家不吝赐教。</p>
<p>&nbsp;</p>
<p>转载 &nbsp;<a href="https://hk.saowen.com/rd/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamFsbHltbi9hcnRpY2xlL2RldGFpbHMvODI3MTY3MQ==" target="_blank">http://blog.csdn.net/jallymn/article/details/8271671</a></p>
<p>李民权</p>
<p>from :<a class="vglnk" href="http://blog.csdn.net/lyflcear/article/details/10055293" rel="nofollow"><span>http</span><span>://</span><span>blog</span><span>.</span><span>csdn</span><span>.</span><span>net</span><span>/</span><span>lyflcear</span><span>/</span><span>article</span><span>/</span><span>details</span><span>/</span><span>10055293</span></a></p>
<p>&nbsp;</p>

</div>
<div id="MySignature">文章乃参考、转载其他博客所得，仅供自己学习作笔记使用！！！</div>                  <p>关键词：<a href="https://hk.saowen.com/search/b::d2Via2l0">webkit</a> <a href="https://hk.saowen.com/search/b::bmV0">net</a> <a href="https://hk.saowen.com/search/b::d2Via2l0YnJvd3Nlcg==">webkitbrowser</a> <a href="https://hk.saowen.com/search/b::5L2%2F55So">使用</a> <a href="https://hk.saowen.com/search/b::d2ViYnJvd3Nlcg==">webbrowser</a> <a href="https://hk.saowen.com/search/b::aHR0cA==">http</a> <a href="https://hk.saowen.com/search/b::6LCD55So">调用</a> <a href="https://hk.saowen.com/search/b::572R6aG1">网页</a> <a href="https://hk.saowen.com/search/b::YnJvd3Nlcg==">browser</a> <a href="https://hk.saowen.com/search/b::bmV3">new</a> </p>
                  <p>相关推荐：</p>
                  <p><a href="https://hk.saowen.com/a/23c7ad5b53ee27c5275674f92d5060df2cac050c50ecfa4e60ef77403f4f1ac6"><strong>解决 winform打开网页 和WebBrowser打开链接360误报拦截的问题</strong></a></p><p><a href="https://hk.saowen.com/a/08c5a467a99f5d4b4298020efccaf6103285284f80c2a0f57a2ea8f6bbf1e057"><strong>【数据结构】B-Tree, B+Tree, B*树介绍</strong></a></p><p><a href="https://hk.saowen.com/a/872c91f6819e91973315d44e57d194b3a5a9ed2cb67dabd1e69acac7860a8158"><strong>C#Winform将WebBowser控件替换为Chrome内核</strong></a></p><p><a href="https://hk.saowen.com/a/f65c5551091e0cc909817515cd9d273696256be08e76612bef09550ffd9de163"><strong>WebBrowser（IE） 与 JS 相互调用</strong></a></p><p><a href="https://hk.saowen.com/a/bea26dbe9290b56e0b9a51b24a1814da90554200dc38485c278f72b549cb4a0a"><strong>webbrowser轻松实现自动填表</strong></a></p><p><a href="https://hk.saowen.com/a/93844a41f59740af5ef5cfc58a55a095df8ea46f7f48079971270ae8ee4d37b7"><strong>MVC  MVC3中 ViewBag、ViewData和TempData的使用和区别 【转】</strong></a></p><p><a href="https://hk.saowen.com/a/b73b8158179b87d5fbe784c0461d2efadea1c1ebc807116b9e51a9a43fbf0ab9"><strong>.NET/C#中对自定义对象集合进行自定义排序的方法</strong></a></p><p><a href="https://hk.saowen.com/a/5a778fbbe314f601d09b0507d0405d8f10be21776c6e5a8d8f5862a23a9319dc"><strong>再学UML-深入浅出UML类图（二）</strong></a></p><p><a href="https://hk.saowen.com/a/5f9f54bdce35249e68d25b2c0f123c9420fc37f287708d10595dc1b65f738cf8"><strong>WinForm webbrowser控件的使用</strong></a></p><p><a href="https://hk.saowen.com/a/2453afba996cc6226879400d13b90907911a04f26af54becc88b98eeb1a2ae12"><strong>黄聪：在.NET中使用GeckoFX 29</strong></a></p>                </section>
                <footer class="post-footer">
                    <!--
                    <figure class="author-image">
                        <a class="img" href="/author/xxx/" style="background-image: url(/content/images/2016/05/46432216001_ffd2d84d48c6cea1eb23_192.jpg)"><span class="hidden">Alex Ellis's Picture</span></a>
                    </figure>
                    -->
                    <section class="author">
                        <h4><a href="https://hk.saowen.com/source/cbb/huangcong">黄聪</a></h4>
                        <p>Read <a href="https://hk.saowen.com/source/cbb/huangcong">more posts</a> by this author.</p>
                        <div class="author-meta">
                            <span class="author-location icon-location">China</span>
                            <span class="author-link icon-link"><a href="https://hk.saowen.com/source/cbb/huangcong">/source/cbb/huangcong</a></span>
                        </div>
                    </section>
                    <section class="share">
                        <h4>Share this post</h4>
                        <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=%E3%80%90%E8%BD%AC%E3%80%91C#%20%E5%BC%80%E5%8F%91Chrome%E5%86%85%E6%A0%B8%E6%B5%8F%E8%A7%88%E5%99%A8(WebKit.net)&amp;url=https://http_backend/a/c34a50f0182958d8f6f18b6e6eed1b3238293819551b790f22a91e1d5997931d" onclick="window.open(this.href, &#39;twitter-share&#39;, &#39;width=550,height=235&#39;);return false;">
                            <span class="hidden">Twitter</span>
                        </a>
                        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://http_backend/a/c34a50f0182958d8f6f18b6e6eed1b3238293819551b790f22a91e1d5997931d" onclick="window.open(this.href, &#39;facebook-share&#39;,&#39;width=580,height=296&#39;);return false;">
                            <span class="hidden">Facebook</span>
                        </a>
                        <a class="icon-google-plus" href="https://plus.google.com/share?url=https://http_backend/a/c34a50f0182958d8f6f18b6e6eed1b3238293819551b790f22a91e1d5997931d" onclick="window.open(this.href, &#39;google-plus-share&#39;, &#39;width=490,height=530&#39;);return false;">
                            <span class="hidden">Google+</span>
                        </a>
                    </section>
                </footer>
                <div id="disqus_thread"><iframe id="dsq-app5588" name="dsq-app5588" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 391px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="dsq-app5591" name="dsq-app5591" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" sandbox="allow-forms allow-popups allow-same-origin allow-scripts" width="100%" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/saved_resource(1).html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 0px !important;"></iframe></div>
                <script>
                  disqus_shortname = 'SAOWEN';
                  disqus_page_url = 'https://http_backend/a/c34a50f0182958d8f6f18b6e6eed1b3238293819551b790f22a91e1d5997931d';
                  disqus_page_title = '【转】C# 开发Chrome内核浏览器(WebKit.net)';
                </script>
                <script>

                /**
                *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
                /*
                var disqus_config = function () {
                this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                */
                (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');
                s.src = 'https://saowen.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </article>
        </main>
        <footer class="site-footer clearfix">
            <section class="copyright"><a href="https://hk.saowen.com/">扫文资讯</a> © 2017 / runtime 0.042589s / size: 19529</section>
            <section class="poweredby">published with <a href="https://hk.saowen.com/">CoreCMS Alpha v0.1</a> <a href="https://www.saowen.com/">CN</a> | <a href="https://tw.saowen.com/">TW</a> | <a href="https://hk.saowen.com/">HK</a> | <a href="https://hk.saowen.com/source/~/cbb">技术 / 编程</a></section>
        </footer>
    </div>
        <script src="https://storage.cdn.dogedoge.com/static/js/lazysizes.min.js" async=""></script>
    <script>
      window.lazySizesConfig = window.lazySizesConfig || {};
      window.lazySizesConfig.lazyClass = 'img_loading';
    //  window.lazySizesConfig.customMedia = {
    //    '--small': '(max-width: 480px)',
    //    '--medium': '(max-width: 900px)',
    //    '--large': '(max-width: 1400px)',
    //  };
    </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/js(1)"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-120209922-1');
  gtag('event', 'timing_complete', {
      'name': 'server_runtime_article',
      'value': 42.589,
      'event_category': 'server_runtime'
    });
</script>

<ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: none !important;"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent;"><ins id="aswift_0_anchor" style="display:block;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent;"><iframe frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0px;width:0px;height:0px;" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/saved_resource(2).html"></iframe></ins></ins></ins><iframe id="google_osd_static_frame_3363323344092" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/saved_resource(3).html"></iframe><iframe style="display: none;" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/saved_resource(4).html"></iframe></body><iframe id="google_shimpl" style="display: none;" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/saved_resource(5).html"></iframe><iframe id="google_esf" name="google_esf" src="./【转】C# 开发Chrome内核浏览器(WebKit.net) - 扫文资讯_files/zrt_lookup.html" data-ad-client="ca-pub-6601249682792819" style="display: none;"></iframe></html>